---

---

<div class="h-[80vh] flex items-center justify-center ">
  <div
    id="formContainer"
    class="bg-white p-8 md:p-10 rounded-2xl shadow-2xl w-full max-w-md flex flex-col items-center justify-center opacity-0 transform translate-y-8 border-2"
  >
    <h2 class="text-3xl font-bold text-gray-800 text-center mb-6">
      游 Cambiar Contrase침a
    </h2>

    <input
      type="password"
      id="password"
      placeholder="Nueva contrase침a"
      class="w-full p-3 border border-gray-300 rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
    <input
      type="password"
      id="confirmPassword"
      placeholder="Confirmar contrase침a"
      class="w-full p-3 border border-gray-300 rounded-lg mb-6 focus:outline-none focus:ring-2 focus:ring-blue-500"
    />

    <button
      id="submitBtn"
      class="w-full bg-black text-white py-3 rounded-lg font-semibold hover:bg-[#e04e52] active:scale-95 transition-transform"
    >
      Guardar
    </button>

    <div id="message" class="mt-4 text-center font-semibold text-sm text-gray-600"></div>
  </div>
</div>


<script>
  import {
    alertaCheck,
    alertaFallo,
    alertaMal,
  } from "../assets/Alertas/Alertas.js";
  import gsap from "gsap";
  import { ruta } from "../utils/ruta.js";

  // Animaci칩n de entrada del formulario
  gsap.to("#formContainer", {
    duration: 0.8,
    opacity: 1,
    y: 0,
    ease: "power2.out",
  });

  const token = new URLSearchParams(window.location.search).get("id_token");
  const btn = document.getElementById("submitBtn");
  const msg = document.getElementById("message");
  console.log(token);

  btn.addEventListener("click", async () => {
    const password = document.getElementById("password").value;
    const confirmPassword = document.getElementById("confirmPassword").value;

    // Validar campos
    if (!password || !confirmPassword) {
      msg.textContent = "Todos los campos son obligatorios";
      msg.className = "mt-4 text-center font-semibold text-red-500";
      return;
    }
    if (password !== confirmPassword) {
      msg.textContent = "Las contrase침as no coinciden";
      msg.className = "mt-4 text-center font-semibold text-red-500";
      return;
    }

    try {
      const res = await fetch(`${ruta}/cambiar-password?id_token=${token}`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ token: token, password: password }),
      });

      const data = await res.json();
      msg.textContent = data.message;
      msg.className = `mt-4 text-center font-semibold $   {
          data.success ? "text-green-500" : "text-red-500"
        }`;
      // Redirigir al inicio
      setTimeout(() => {
        alertaCheck(data.message);
        location.href = "/";
      }, 1500);

      // Animaci칩n de 칠xito
      if (data.success) {
        gsap.to("#formContainer", {
          scale: 1.05,
          duration: 0.2,
          yoyo: true,
          repeat: 1,
        });
      }
    } catch (error) {
      msg.textContent = "Error de conexi칩n con el servidor";
      msg.className = "mt-4 text-center font-semibold text-red-500";
      alertaFallo("Error de conexi칩n con el servidor");
    }
  });
</script>
